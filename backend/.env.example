# Backend configuration for LiquidBot - On-Chain Monitoring Only

PORT=3000
NODE_ENV=development

# Database
DATABASE_URL=postgres://postgres:postgres@localhost:5432/liquidbot

# Redis (choose either URL or host/port)
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
# REDIS_URL=redis://127.0.0.1:6379

# Aave V3 Base Addresses
AAVE_POOL_ADDRESS=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5
AAVE_POOL=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5

# Aave V3 Base Data Provider Addresses (for dynamic liquidation sizing)
AAVE_ADDRESSES_PROVIDER=0xe20fCBdBfFC4Dd138cE8b2E6FBb6CB49777ad64D
AAVE_PROTOCOL_DATA_PROVIDER=0xC4Fcf9893072d61Cc2899C0054877Cb752587981
AAVE_ORACLE=0x2Cc0Fc26eD4563A5ce5e8bdcfe1A2878676Ae156
AAVE_POOL_CONFIGURATOR=0x5731a04B1E775f0fdd454Bf70f3335886e9A96be
AAVE_UI_POOL_DATA_PROVIDER=0x68100bD5345eA474D93577127C11F39FF8463e93
AAVE_WRAPPED_TOKEN_GATEWAY=0xa0d9C1E9E48Ca30c8d8C3B5D69FF5dc1f6DFfC24

# Auth
JWT_SECRET=replace_me
API_KEY=dev_key

# Telegram Notifications (optional - will be disabled if not set)
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here

# Health Monitoring Thresholds
HEALTH_ALERT_THRESHOLD=1.10
HEALTH_EMERGENCY_THRESHOLD=1.05

# Profit Estimation
PROFIT_FEE_BPS=30
PROFIT_MIN_USD=10

# Price Oracle (placeholder for future integration)
PRICE_ORACLE_MODE=coingecko

# Health Factor Resolution Mode
HEALTH_QUERY_MODE=on_demand

# Gas Cost Estimation
GAS_COST_USD=0.5

# Real-Time Health Factor Detection (On-Chain Only)
USE_REALTIME_HF=true

# WebSocket RPC URL for real-time monitoring (required for real-time mode)
WS_RPC_URL=wss://base-mainnet.g.alchemy.com/v2/your-api-key

# Optional: Flashblocks for pending transaction monitoring
USE_FLASHBLOCKS=false
# FLASHBLOCKS_WS_URL=wss://base.flashblocks.io
# FLASHBLOCKS_TICK_MS=250

# Multicall3 address for batch health factor checks
MULTICALL3_ADDRESS=0xca11bde05977b3631167028862be2a173976ca11

# Health factor threshold for liquidation execution (basis points, 9800 = 0.98)
EXECUTION_HF_THRESHOLD_BPS=9800

# Maximum number of candidate addresses to track
CANDIDATE_MAX=300

# Hysteresis threshold for repeat notifications (basis points, 20 = 0.2%)
HYSTERESIS_BPS=20

# Only notify when liquidation plan is actionable (has resolvable debt/collateral)
NOTIFY_ONLY_WHEN_ACTIONABLE=true

# Prevent duplicate execution attempts on same user
EXECUTION_INFLIGHT_LOCK=true

# On-Chain Backfill Configuration (Initial Candidate Discovery)
# Enable backfill from historical Aave Pool events at startup
REALTIME_INITIAL_BACKFILL_ENABLED=true

# Number of blocks to scan backward for initial candidates (default: 50000)
REALTIME_INITIAL_BACKFILL_BLOCKS=50000

# Maximum logs to process during backfill (safety cap, default: 20000)
REALTIME_INITIAL_BACKFILL_MAX_LOGS=20000

# Block chunk size for paginated getLogs queries (default: 2000)
REALTIME_INITIAL_BACKFILL_CHUNK_BLOCKS=2000

# Chainlink Price Feeds (optional - for selective low-HF rechecks on price changes)
# RPC URL for Chainlink price feed queries
# CHAINLINK_RPC_URL=https://mainnet.base.org
# Comma-separated list of token:feedAddress pairs
# CHAINLINK_FEEDS=ETH:0x71041dddad3595F9CEd3DcCFBe3D1F4b0a16Bb70,USDC:0x7e860098F58bBFC8648a4311b374B1D669a2bc6B

# Execution Controls (all optional - defaults are safe)
EXECUTION_ENABLED=false              # Master switch (default: false)
DRY_RUN_EXECUTION=true               # Simulate only (default: true)
MAX_GAS_PRICE_GWEI=50                # Skip if gas too high (default: 50)
MIN_PROFIT_AFTER_GAS_USD=10          # Min profit threshold (default: 10)

# Risk Management
MAX_POSITION_SIZE_USD=5000           # Per-liquidation cap (default: 5000)
DAILY_LOSS_LIMIT_USD=1000            # Daily loss limit (default: 1000)
BLACKLISTED_TOKENS=                  # Comma-separated, e.g., WBTC,XYZ

# Optional MEV Protection
# PRIVATE_BUNDLE_RPC=https://rpc.flashbots.net

# On-Chain Executor Configuration (for liquidation execution)
# EXECUTOR_ADDRESS=0x...              # Deployed LiquidationExecutor contract address
# EXECUTION_PRIVATE_KEY=0x...         # Private key for signing transactions (KEEP SECRET!)
# RPC_URL=https://mainnet.base.org    # Base RPC endpoint for transaction submission
# CHAIN_ID=8453                       # Base chain ID
# ONEINCH_API_KEY=...                 # 1inch API key for swap quotes
# ONEINCH_BASE_URL=https://api.1inch.dev/swap/v6.0/8453  # 1inch API URL
# MAX_SLIPPAGE_BPS=100                # Max slippage for swaps (100 = 1%)
# CLOSE_FACTOR_MODE=auto              # Close factor mode: 'auto' or 'fixed'
# CLOSE_FACTOR_EXECUTION_MODE=fixed50 # Execution mode: 'fixed50' or 'full'
# LIQUIDATION_DEBT_ASSETS=usdc,usdbc  # Comma-separated list of preferred debt assets

