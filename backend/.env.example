# Example configuration emphasizing header-mode usage

PORT=3000
NODE_ENV=development

USE_MOCK_SUBGRAPH=false
# Header-mode endpoint (preferred: key not in URL)
SUBGRAPH_URL=https://gateway.thegraph.com/api/subgraphs/id/GQFbb95cE6d8mV989mL5figjaGaKCQB3xqYrr1bRyXqF
GRAPH_API_KEY=replace_with_gateway_key

# (If you omit SUBGRAPH_URL the service defaults to path-embedded:
# https://gateway.thegraph.com/api/<GRAPH_API_KEY>/subgraphs/id/<DEPLOYMENT_ID>
# )

SUBGRAPH_POLL_INTERVAL_MS=15000

# Liquidation Tracking
# Maximum liquidations to fetch per poll (default: 50)
LIQUIDATION_POLL_LIMIT=50
# Maximum unique liquidation IDs to track (default: 5000)
LIQUIDATION_TRACK_MAX=5000

# Resilience & Metrics
SUBGRAPH_FAILURE_THRESHOLD=5
SUBGRAPH_RETRY_ATTEMPTS=3
SUBGRAPH_RETRY_BASE_MS=150
SUBGRAPH_RATE_LIMIT_CAPACITY=30
SUBGRAPH_RATE_LIMIT_INTERVAL_MS=10000

# Database
DATABASE_URL=postgres://postgres:postgres@localhost:5432/liquidbot

# Redis (choose either URL or host/port)
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
# REDIS_URL=redis://127.0.0.1:6379

# Aave Pool (Base)
AAVE_POOL_ADDRESS=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5

# Auth
JWT_SECRET=replace_me
API_KEY=dev_key

# Debug deeper subgraph errors
# SUBGRAPH_DEBUG_ERRORS=true

# Telegram Notifications (optional - will be disabled if not set)
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here

# Health Monitoring (thresholds kept for reference, monitoring disabled)
HEALTH_ALERT_THRESHOLD=1.10
HEALTH_EMERGENCY_THRESHOLD=1.05

# Profit Estimation
PROFIT_FEE_BPS=30
PROFIT_MIN_USD=10

# Price Oracle (placeholder for future integration)
PRICE_ORACLE_MODE=coingecko

# Health Factor Resolution Mode
# Note: Bulk monitoring disabled. Health factors resolved on-demand per liquidation.
HEALTH_QUERY_MODE=on_demand

# Poll Configuration
# Maximum new liquidations to process per poll (default: 5)
POLL_LIMIT=5
# Ignore first (bootstrap) batch for notifications/opportunity pipeline (default: true)
IGNORE_BOOTSTRAP_BATCH=true

# Gas Cost Estimation
# Gas cost in USD for profit calculations (default: 0)
GAS_COST_USD=0

# Chainlink Price Feeds (optional - falls back to stub prices if not configured)
# RPC URL for Chainlink price feed queries
# CHAINLINK_RPC_URL=https://mainnet.base.org
# Comma-separated list of token:feedAddress pairs
# CHAINLINK_FEEDS=ETH:0x71041dddad3595F9CEd3DcCFBe3D1F4b0a16Bb70,USDC:0x7e860098F58bBFC8648a4311b374B1D669a2bc6B

# At-Risk User Scanning (Optional)
# Number of users to scan per poll cycle (0 disables scanning)
AT_RISK_SCAN_LIMIT=50
# Health factor threshold for warning tier (HF below this triggers warning)
AT_RISK_WARN_THRESHOLD=1.05
# Health factor threshold for critical tier (HF below this is liquidatable)
AT_RISK_LIQ_THRESHOLD=1.0
# Debt threshold in ETH below which debt is considered dust (effectively zero)
AT_RISK_DUST_EPSILON=1e-9
# Whether to send notifications for warn tier users (critical always notified)
AT_RISK_NOTIFY_WARN=false
