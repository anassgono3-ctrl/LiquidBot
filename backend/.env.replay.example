# Historical Replay Mode Configuration Example
# Copy this file to .env or append to your existing .env file

# ==== CORE REPLAY SETTINGS ====
REPLAY_ENABLED=true
REPLAY_MODE=simulate              # observe | simulate | hybrid | exec-fork
REPLAY_START_BLOCK=38393176       # First block to replay
REPLAY_END_BLOCK=38395221         # Last block to replay (inclusive)
REPLAY_CHAIN_ID=8453              # Chain ID (8453 = Base)

# ==== PERFORMANCE CONTROLS ====
REPLAY_SPEED=accelerated          # realtime | accelerated | max
REPLAY_BLOCK_STEP=1               # Process every N blocks (1 = every block)
REPLAY_SLEEP_MS=0                 # Override sleep between blocks (0 = use speed default)

# ==== DATA SOURCES ====
REPLAY_PRICE_SOURCE=oracle        # oracle | subgraph | mixed
REPLAY_COMPARE_WITH_ONCHAIN=true  # Load ground truth liquidations for comparison

# ==== OUTPUT CONFIGURATION ====
REPLAY_EXPORT_DIR=./replay/out    # Output directory for JSONL artifacts
REPLAY_LOG_CALDATA=true           # Include calldata in logs
REPLAY_LOG_MISSED=true            # Write missed.jsonl for missed liquidations

# ==== ERROR HANDLING ====
REPLAY_PAUSE_ON_ERROR=true        # Stop after max errors exceeded
REPLAY_MAX_BLOCK_ERRORS=10        # Max block errors before stopping

# ==== THRESHOLD OVERRIDES (for analysis) ====
REPLAY_INCLUDE_LOW_DEBT=false     # Include positions below MIN_DEBT_USD
# REPLAY_FORCE_MIN_DEBT_USD=100   # Override MIN_DEBT_USD (optional)
# REPLAY_FORCE_MIN_PROFIT_USD=10  # Override MIN_PROFIT_USD (optional)

# ==== FORK EXECUTION (for exec-fork mode only) ====
# REPLAY_LOCAL_FORK_URL=http://localhost:8545  # Local Anvil/Foundry fork URL
# REPLAY_FORK_AUTO_ADVANCE=true                # Auto-advance fork blocks

# ==== REQUIRED: RPC CONFIGURATION ====
# Archive node required for historical state queries
RPC_URL=https://base-mainnet.infura.io/v3/YOUR_KEY
BACKFILL_RPC_URL=${RPC_URL}       # Fallback to RPC_URL if not set

# ==== REQUIRED: AAVE CONFIGURATION ====
AAVE_POOL_ADDRESS=0xA238Dd80C259a72e81d7e4664a9801593F98d1c5
AAVE_ORACLE=0x2Cc0Fc26eD4563A5ce5e8bdcfe1A2878676Ae156
AAVE_ADDRESSES_PROVIDER=0xe20fCBdBfFC4Dd138cE8b2E6FBb6CB49777ad64D
AAVE_PROTOCOL_DATA_PROVIDER=0x2d8A3C5677189723C4cB8873CfC9C8976FDF38Ac

# ==== OPTIONAL: SUBGRAPH (for faster ground truth loading) ====
# SUBGRAPH_URL=https://api.studio.thegraph.com/query/.../aave-v3-base/version/latest

# ==== SAFETY: EXECUTION MUST BE DISABLED ====
EXECUTION_ENABLED=false           # REQUIRED: Must be false in replay mode
DRY_RUN_EXECUTION=true            # Additional safety flag

# ==== OTHER REQUIRED CONFIG (from main .env) ====
API_KEY=replay-mode-key
JWT_SECRET=replay-mode-secret
USE_SUBGRAPH=false                # Optional: Set to true if using subgraph
